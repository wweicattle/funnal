<template>
  <div class="furnish">
    <div class="furnish_content">
      <div class="furnish_html scrollbar-css" ref="html" @scroll="scrollEvent">
        <table border="0px" width="100%" style="margin:0px;">
          <tbody>
            <tr>
              <h1>利郎专卖店装修合作协议书(样本)</h1>
            </tr>
            <tr>
              <div style="display: flex;">
                <div>
                  <p>甲方：</p>
                  <p>乙方：</p>
                </div>
                <div>
                  <p>
                    <b>利郎（中国）有限公司</b>
                  </p>
                  <p></p>
                </div>
                <div>
                  <p>（以下简称甲方）</p>
                  <p>（以下简称乙方）</p>
                </div>
              </div>
            </tr>

            <td style="font-size:14px;">
              <div>
                <div>甲乙双方本着互惠互利、公平合理、共同发展的原则，经友好协商，就甲方将 省内专卖店装修工程，委托给乙方承包事宜，达成以下合作协议：</div>
                <div class="col">
                  <!-- <div style="font-size: 18px;font-weight: bold;line-height: 32px;margin: 10px 0;color:#333333;" class="h2" id="h2-1">
                    <b>一、 合作项目与价格：</b>
                  </div>-->
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-1">
                    <b>一、 合作项目与价格：</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>工程报价：根据甲方开设专卖店的标准装修方案，决定就以下施工项目与乙方进行合作，乙方在开工之前，预先对施工项目的单价、数量进行分类报价。施工过程中，如因方案调整使实际工程量或价格有所变动，乙方可于工程结束后，跟甲方进行实事求是的结算；（附工程项目报价单）</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>合作以甲方执行部门（该省分公司或办事机构以及总部营销公司）与乙方签订的协议为准确依据。</div>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-2">
                    <b>二、 付款方式：</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>采用银行汇款，乙方提供公司帐号；</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>
                      本协议签订后，乙方施工队进工地的三天内，甲方预付人民币
                      <div class="line"></div>元整，支持乙方进行备料施工。为考虑乙方工程质量保证及货款转接手续的问题，当专卖店的装修进度到达吊顶封板的程度，甲方经对已竣工的工程部分检验合格后先拨付人民币
                      <div class="line"></div>元整，并依据利郎公司财务有关专卖店装修的规定，保留余款作为品质/服务保证金。待乙方完成全部工程，经甲方验收合格后，支付全部余额。
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-3">
                    <b>三、 完工期限：</b>
                  </div>
                  <div style="display:flex;">
                    <div>
                      常规情况下，乙方承诺于
                      <div class="line" style="width:30px"></div>年
                      <div class="line" style="width:30px"></div>月
                      <div class="line" style="width:30px"></div>日之前，保质保量完成协议约定的施工项目，交付甲方使用。
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-4">
                    <b>四、 施工要求：</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>乙方应严格按甲方提供的标准施工图纸上的项目、材料、风格（空调、消防除外）和甲方的其它要求保质保量地进行施工。施工过程中，乙方未经甲方许可不得擅自更改甲方的设计方案及材料要求等；</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>施工期间，甲方有权派出相关人员对乙方的施工进度、施工用材进行监督和维护，乙方应积极配合。</div>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-5">
                    <b>五、 违约责任</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>施工所用的材料必须是甲方规定的品牌和型号，乙方不得偷工减料或擅自变换装修材料，并保证甲方专卖店在正常环境下，不变形、不脱落、不破损。如发生类似质量问题，乙方须在一周内无偿地进行材料更换或者维修，并承担由此产生的一切费用；</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>
                      乙方不能按合同规定时间完工，或因质量问题影响甲方正常开业运营，每超过约定日期一天，甲方将扣除乙方人民币
                      <div class="line" style="width:20px;"></div>元作为惩罚，并且乙方应赔偿甲方由于延时开业造成的实际经济损失；
                    </div>
                  </div>
                  <div style="display:flex;">
                    3、
                    <div>工程完成后，由甲乙双方组织相关人员共同进行质量验收，经检验如发现质量问题，甲方可要求乙方无偿返工，直至验收合格。由于返工造成的所有损失，均由乙方自行承担；</div>
                  </div>
                  <div style="display:flex;">
                    4、
                    <div>
                      乙方必须严格按照甲方规定的项目和要求进行装修，不得随意按他人意见增加或更改工程项目。如每发现类似情况一次，甲方将扣除乙方
                      <div class="line" style="width:20px;"></div>元作为违约赔偿；
                    </div>
                  </div>
                  <div style="display:flex;">
                    5、
                    <div>以上1－4项违约责任中，经双方确认责任及赔偿金额后，即在结算时货款中扣除。</div>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-6">
                    <b>六、 其他约定事项：</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>为保障财产安全，乙方派往装修现场施工的人员，需向甲方提交身份证复印件，如乙方工程队的人员在施工期间发生损害甲方财产的行为，乙方必须承担全部责任；</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>乙方工程队的人员在施工期间必须保证安全施工，如发生人身安全问题，乙方负全部责任；</div>
                  </div>
                  <div style="display:flex;">
                    3、
                    <div>施工期间，乙方应保持环境卫生，如发生城管问题，乙方应负全部责任；施工期间，甲方无偿对乙方提供指导和进行相关协助；</div>
                  </div>
                  <div style="display:flex;">
                    4、
                    <div>乙方应对甲方的装修方案有保密维权责任，不得随意应用于其他单位的装修，否则，甲方将追究责任；</div>
                  </div>
                  <div style="display:flex;">
                    5、
                    <div>双方业务往来作风要正，乙方不得与甲方任何人产生行贿或回扣行为，一经发现甲方将乙方余留货款作为违约金，并取消合作关系。</div>
                  </div>
                </div>
                <div class="col" style="display:flex;align-items: center;">
                  <div style="font-size: 16px;line-height: 32px;color:#333333;" class="h2" id="h2-7">
                    <b>七、 协议有效期限：</b>
                  </div>
                  <div>
                    <span style="font-weight:400;">
                      200
                      <div class="line" style="width:20px;"></div>年
                      <div class="line" style="width:20px;"></div>月
                      <div class="line" style="width:20px;"></div>日至200 年 月 日止。
                    </span>
                  </div>
                </div>
                <div class="col">
                  <div style="font-size: 16px;font-weight: bold;line-height: 32px;color:#333333;" class="h2" id="h2-8">
                    <b>八、 补充说明：</b>
                  </div>
                  <div style="display:flex;">
                    1、
                    <div>本协议未尽事宜，经双方友好协商后可签订补充协议；</div>
                  </div>
                  <div style="display:flex;">
                    2、
                    <div>本协议适用《中华人民共和国合同法》及其他相关法规；若因本协议引起的任何争议，双方友好协商解决，若经协商仍无法解决，可在合同签订地法院进行诉讼解决。</div>
                  </div>
                </div>
                <div style="margin-top:5px">
                  <b>本协议经双方法定代表签字盖章后即生效执行，正本一式叁份，甲方执贰份（总部/分公司各壹份），乙方执壹份。</b>
                </div>
              </div>
            </td>
          </tbody>
        </table>
      </div>
      <div class="furnish_agree">
        <div class="partyA">
          <p>甲方：利郎（中国）有限公司</p>
          <p>地址：晋江市长兴路200号利郎工业园</p>
          <p>代表(签章)：</p>
          <p>签订日期：</p>
        </div>
        <div class="partyB">
          <p>乙方：</p>
          <p>地址：</p>
          <p>代表(签章)：</p>
          <p>签订日期：</p>
        </div>
      </div>
    </div>
    <div class="furnish_nav">
      <div class="furnish_nav_title">条款目录</div>
      <div class="termas_nav_item" v-if="anchorList.length == 0">
        <p>暂无目录</p>
      </div>
      <div class="termas_nav_item" v-for="(item, index) in anchorPoint" :key="index">
        <p :class="{ 'termas_nav_item-active': anchor.parent == item.href }" class="nav1" @click="goAnchor(item)">{{ item.name }}</p>
        <div class="nav2" v-for="(child, k) in item.children" :key="k">
          <p :class="{ 'termas_nav_item-active': anchor.child == child.href }" @click="goAnchor(child)">{{ child.name }}</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      anchorPoint: [],
      anchor: {},
      anchorList: [],
      htmls: '',
    };
  },
  mounted() {
    this.$nextTick(() => {
      const col = this.$refs.html.querySelectorAll('.col');
      col.forEach((element) => {
        let obj = { name: element.querySelector('.h2').outerText.replace('：', ''), href: '#' + element.querySelector('.h2').id, children: [] };
        console.log(obj);
        this.anchorList.push({ name: element.querySelector('.h2').outerText, href: '#' + element.querySelector('.h2').id })
        element.querySelectorAll('.h3').forEach((item) => {
          obj.children.push({ name: item.outerText, href: '#' + item.id });
          this.anchorList.push({ name: item.outerText, href: '#' + item.id });
        });
        this.anchorPoint.push(obj);
      });
    })


  },
  methods: {
    goAnchor(selector) {
      const anchor = this.$el.querySelector(selector.href)
      anchor.scrollIntoView(true)
    },
    scrollEvent() {
      let anchorPoint = this.anchorPoint
      const scrollTop = this.$refs.html.scrollTop
      let anchor = {}
      scrollTop && anchorPoint.forEach(ele => {
        if (this.$el.querySelector(ele.href).offsetTop < scrollTop) {
          ele.children.forEach(item => {
            this.$el.querySelector(item.href).offsetTop < scrollTop && this.$set(anchor, 'child', item.href)
          })
          anchor.parent = ele.href
          if (ele.children.length == 0) {
            anchor.child = ''
          }
        }
      })
      this.anchor = anchor
    },
  }
};
</script>

<style scoped lang="scss">
// @import url(./reset.scss);
.furnish {
  width: 100%;
}
.furnish {
  width: 100%;
  height: 100%;
  overflow: hidden;
  display: flex;
}
.furnish_content {
  width: calc(100% - 250px);
  height: 100%;
  background: #ffffff;
  box-shadow: 0px 1px 15px 0px rgba(222, 222, 222, 0.2);
  border-radius: 8px;
  // padding: 0 37px;
  display: flex;
  flex-direction: column;
  .furnish_html {
    flex: 1;
    overflow-y: auto;
    width: 100%;
    padding: 0 37px;
    color: #333333;
    div {
      font-size: var(--font-size);
      line-height: 1.7em;
    }
  }
  .furnish_agree {
    padding: 18px 37px;
    border-top: 1px dashed #f3f3f3;
    display: flex;
    width: 100%;
    div {
      flex: 1;
      font-size: var(--font-size);
      font-weight: bold;
      color: var(--text-color);
      line-height: 25px;
      &:first-child {
        margin-right: 76px;
      }
    }
  }
}
.furnish_nav {
  margin-left: 30px;
  width: 220px;
  height: 360px;
  background: #ffffff;
  box-shadow: 0px 1px 15px 2px rgba(222, 222, 222, 0.2);
  border-radius: 8px;
  padding: 15px 25px;

  .furnish_nav_title {
    font-size: 16px;
    font-weight: 500;
    color: #333333;
    line-height: 22px;
    margin-bottom: 15px;
  }
  .termas_nav_item {
    font-weight: 400;
    color: #8d94a2;

    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    // margin-top: 10px;
    .nav1 {
      position: relative;
      cursor: pointer;
      // padding-left: 12px;
      font-size: var(--font-size);
      line-height: 1.5em;
      margin-bottom: 5px;
      width: 100%;
      p {
        width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      &:hover {
        color: var(--sle-text-color);
        &::before {
          background: var(--sle-text-color);
        }
      }
      &:active {
        color: var(--sle-text-color);
      }
    }
    .nav2 {
      p {
        padding-left: 12px;
        margin-bottom: 5px;
        font-size: var(--font-size);
        line-height: 1.5em;
        cursor: pointer;
        width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        &:hover {
          color: #0670ff;
        }
        &:active {
          color: #0670ff;
        }
      }
    }
    .termas_nav_item-active {
      color: #0670ff;
      // &::before {
      //   background: #0670ff;
      // }
    }
  }
}
.line {
  width: 50px;
  height: var(--font-size);
  margin-right: 3px;
  display: inline-block;
  border-bottom: 1px solid #333;
}
</style>
